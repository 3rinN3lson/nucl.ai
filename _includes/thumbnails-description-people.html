{% if items != site.data.people %} {% comment %} items are filtered {% endcomment %}
    {% for person in site.data.people %}
        {% if person.name == desc %}
            {% assign d = person %}
        {% endif %}
    {% endfor %}
{% else %}
    {% assign d = desc %}
{% endif %}

{% if lastRow %} {% capture lastRow %}last-row{% endcapture %} {% endif %}
{% assign descModulo = descIndex | plus:1 | modulo:itemsInRow %}

<item class="description {{lastRow}} animated fadeOutRight" name="{{ d.name | escape}}">
    
    <div class="thumbnail-title 
        column-{{descModulo}}
        {{itemsInRow}}-in-row
        {% if descModulo == 1 %} column-first 
        {% elsif descModulo == 0 %} column-last
        {% elsif itemsInRow == 3 %} column-middle
        {% endif %}
    ">
        <div class="thumbnail-title-wrap">
            <h2> {{ d.name }} </h2>
            <div class="affiliation-wrap">
            {% if d.affiliation.position %}
                <p class="affiliation-position">
                    {{>d.affiliation.position}}
                </p>
            {% else %}
                <p class="affiliation-position no-data" style="visibility:hidden;">
                    no data
                </p>
            {% endif %}

            {% if d.affiliation.name %}
                <p class="affiliation">
                    <a href="{{d.affiliation.url}}" target="_blank">{{>d.affiliation.name}}</a>
                </p>
            {% endif %}
            </div>
        </div>
    <div style="clear: both"> </div>

    </div>

    <p class="conference-title"> {{ d.title }} </p>
    <p class="links"> 
    {% if d.twitter %}
        <a class="social twitter" href="http://twitter.com/{{d.twitter}}" target="_blank"></a>
    {% endif %}
    </p>
    {% comment %} get speaker talks {% endcomment %}
    <ul class="talks-list">
        {% for topic in site.data.topics %}
            {% assign talks = site.data.tracks[topic.id] %}
            {% for talk in talks %}
                {% for speaker in talk.speakers %}
                    {% if speaker == d.name %}
                        <li class="track-topic">
                            <a href="/track/{{topic.id}}#{{talk.title | replace:':','-' | replace:'&','and' | escape | replace:' ','-' | downcase}}">
                                {{talk.title}}
                            </a>
                        </li>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    </ul>

    {% if d.bio %}
        {% for paragraph in d.bio %}
            <p class="bio">
                {{ paragraph }}
            </p>
        {% endfor %}
    {% else %} 
        {% comment%} put at least one even empty bio to not breake layout {% endcomment%}
        <p class="bio"></p>
    {% endif %}

    <ul>

    {% assign tracks = "" %}

    {% for topic in d.tracks %}
        {% if tracks contains topics %}
        {% else %}
        {% capture tracks %}{% if tracks != "" %}{{tracks}},{% endif %}{{topic}}{% endcapture %}
        {% endif %}
    {% endfor %}

    {% for topic in site.data.topics %}
        {% assign talks = site.data.tracks[topic.id] %}
        {% for talk in talks %}
            {% for speaker in talk.speakers %}
                {% if speaker == d.name %}
                    {% if tracks contains topic.id %}
                    {% else %}
                    {% capture tracks %}{% if tracks != "" %}{{tracks}},{% endif %}{{topic.id}}{% endcapture %}
                    {% endif %}
                {% endif %}
            {% endfor %}
        {% endfor %}
    {% endfor %}
    {% assign tracksArray = tracks | split:","%}
    {% for topic in tracksArray | split:"," %}
        <li class="track">
            <a href="/track/{{topic}}">
                {% for t in site.data.topics %}
                    {% if t.id == topic %}
                        {{t.title}}
                    {% endif %}
                {% endfor %}
            </a>
        </li>
    {% endfor %}

    </ul>
</item>
